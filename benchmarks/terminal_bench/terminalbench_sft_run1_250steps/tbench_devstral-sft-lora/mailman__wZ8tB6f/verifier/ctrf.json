{
    "results": {
        "tool": {
            "name": "pytest",
            "version": "8.4.1"
        },
        "summary": {
            "tests": 3,
            "passed": 1,
            "failed": 2,
            "skipped": 0,
            "pending": 0,
            "other": 0,
            "start": 1768182601.2101347,
            "stop": 1768182664.358125
        },
        "tests": [
            {
                "name": "test_outputs.py::test_simple_local_delivery",
                "status": "failed",
                "raw_status": "call_failed",
                "duration": 30.05255648790626,
                "start": 1768182601.4142163,
                "stop": 1768182631.4889817,
                "retries": 0,
                "file_path": "test_outputs.py",
                "trace": "def test_simple_local_delivery():\n        \"\"\"Test that postfix can deliver mail to local users\n        and that the email content is accessible in their local mailboxes.\n        \"\"\"\n        user = \"bobgreen\"\n        add_user(user)\n        mbox_path = f\"/var/mail/{user}\"\n        subject = \"Direct Message\"\n        send_email(\n            from_addr=f\"{user}@{DOMAIN_NAME}\",\n            to_addr=f\"{user}@{DOMAIN_NAME}\",\n            subject=subject,\n            body=\"Direct test message\",\n        )\n    \n        def _assert_mailbox_exists():\n            assert os.path.exists(mbox_path), f\"Mailbox not found: {mbox_path}\"\n    \n        def _assert_receipt():\n            mbox = mailbox.mbox(mbox_path)\n            found = any(email_msg.get(\"Subject\", \"\") == subject for email_msg in mbox)\n            assert found, f\"Direct email not found in {mbox_path}\"\n    \n>       retry(_assert_mailbox_exists)\n\n/tests/test_outputs.py:159: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/tests/test_outputs.py:52: in retry\n    raise e\n/tests/test_outputs.py:48: in retry\n    return func()\n           ^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    def _assert_mailbox_exists():\n>       assert os.path.exists(mbox_path), f\"Mailbox not found: {mbox_path}\"\nE       AssertionError: Mailbox not found: /var/mail/bobgreen\nE       assert False\nE        +  where False = <function exists at 0x7d71e5acf560>('/var/mail/bobgreen')\nE        +    where <function exists at 0x7d71e5acf560> = <module 'posixpath' (frozen)>.exists\nE        +      where <module 'posixpath' (frozen)> = os.path\n\n/tests/test_outputs.py:152: AssertionError",
                "message": "The test failed in the call phase due to an assertion error"
            },
            {
                "name": "test_outputs.py::test_mlist_exists",
                "status": "passed",
                "duration": 2.7806396409869194,
                "start": 1768182631.4892344,
                "stop": 1768182634.2701404,
                "retries": 0,
                "file_path": "test_outputs.py"
            },
            {
                "name": "test_outputs.py::test_join_announce_leave_flow",
                "status": "failed",
                "raw_status": "call_failed",
                "duration": 30.078345560992602,
                "start": 1768182634.2708905,
                "stop": 1768182664.357925,
                "retries": 0,
                "file_path": "test_outputs.py",
                "trace": "def test_join_announce_leave_flow():\n        \"\"\"Full flow of user joining, announcing, and leaving the mailing list.\"\"\"\n        subject = \"Secret Announcement\"\n        user = \"alicegray\"\n        add_user(user)\n        mbox_path = f\"/var/mail/{user}\"\n    \n        def _assert_mailbox_exists():\n            assert os.path.exists(mbox_path), f\"Mailbox not found: {mbox_path}\"\n    \n        def _assert_not_member():\n            mlist = get_mlist()\n            user_member = mlist.members.get_member(f\"{user}@{DOMAIN_NAME}\")\n            assert user_member is None, f\"{user} is a member: {user_member=}\"\n    \n        def _assert_member():\n            mlist = get_mlist()\n            user_member = mlist.members.get_member(f\"{user}@{DOMAIN_NAME}\")\n            assert user_member, f\"{user} is not a member: {user_member=}\"\n    \n        def _assert_announcement():\n            mbox = mailbox.mbox(mbox_path)\n            announce_msgs = [msg for msg in mbox if subject in msg.get(\"Subject\", \"\")]\n            assert len(announce_msgs) == 1, (\n                f\"Expected 1 announcement, found {len(announce_msgs)}\"\n            )\n    \n        send_email(\n            body=\"\",\n            subject=\"\",\n            from_addr=f\"{user}@{DOMAIN_NAME}\",\n            to_addr=JOIN_LIST,\n        )\n        print(f\"{user} sends a join request\")\n        retry(_assert_not_member)\n        print(f\"{user} has not yet confirmed their subscription\")\n    \n>       retry(_assert_mailbox_exists)\n\n/tests/test_outputs.py:207: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/tests/test_outputs.py:52: in retry\n    raise e\n/tests/test_outputs.py:48: in retry\n    return func()\n           ^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n    def _assert_mailbox_exists():\n>       assert os.path.exists(mbox_path), f\"Mailbox not found: {mbox_path}\"\nE       AssertionError: Mailbox not found: /var/mail/alicegray\nE       assert False\nE        +  where False = <function exists at 0x7d71e5acf560>('/var/mail/alicegray')\nE        +    where <function exists at 0x7d71e5acf560> = <module 'posixpath' (frozen)>.exists\nE        +      where <module 'posixpath' (frozen)> = os.path\n\n/tests/test_outputs.py:178: AssertionError",
                "message": "The test failed in the call phase due to an assertion error"
            }
        ]
    }
}